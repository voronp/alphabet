import{d as L,r as s,g as G,a as H,u as J,b as K,c as T,o as M,e as x,f,n as z,t as O,h as r,i as V,w as B,v as D,j as _,k as Q,l as y,s as g,m as e,p as U,q as W,_ as X}from"./index-eaa31de5.js";import{B as Y}from"./BaseFireworks-82c7676c.js";const Z=L("syllable",()=>{const k=s("");return{text:k,updateText:()=>{k.value=G()}}},{persist:!0}),$={class:"syllable-wrapper"},ee={class:"syllable-container"},se={class:"go-content center-icon"},ae={class:"pause-container center-icon"},te={class:"restart-container center-icon"},le={key:0,class:"bottom-container"},oe=H({__name:"SyllableView",setup(k){const c=Z(),w=J(),I=K(),t=s(0),n=s(!1),m=s(!1),S=s(!1),h=s(!1),u=s(!1),o=s(!1),v=s(!1),b=T(()=>t.value>0),d=T(()=>t.value>=w.answerCount),C=s(!1),i=async a=>new Promise(p=>{setTimeout(()=>p(!0),a)}),F=async()=>{if(o.value)return;c.updateText(),m.value=!1,t.value+=1;let a=0;if(e)try{e.start(),e.onresult=l=>{console.log(l)},e.onspeechend=()=>{console.log("onspeechend")},e.onnomatch=l=>{console.log("onnomatch",l)},e.onerror=l=>{console.log("onerror",l)}}catch(l){console.log(l)}for(;a*1e3<w.answerDelay||n.value;){if(v.value){v.value=!1;break}await i(1e3),a+=1}if(o.value)return;e&&e.stop();const p=i(1500);U(c.text),W(),await p,!o.value&&(m.value=!0,await i(w.pauseDelay),v.value=!1,d.value&&(C.value=!0))},P=()=>{C.value=!1;const a=async()=>{if(!o.value){if(d.value){console.log("done"),I.resultItems.push({datetime:new Date,type:"syllable",totalItems:t.value,successItems:t.value}),h.value=!0,await i(3e3),S.value=!0,await i(1e3),h.value=!1,S.value=!1,u.value=!0;return}await F(),a()}};a()},R=()=>P(),E=()=>{d.value||(n.value=!0)},N=()=>{n.value=!1},j=()=>{v.value=!0},q=()=>{o.value=!1,t.value=0,u.value=!1},A=()=>{o.value=!0,e&&e.stop(),u.value=!0,t.value=0};return M(()=>{console.log("leave"),A()}),(a,p)=>(y(),x("div",$,[f("div",ee,[b.value?(y(),x("div",{key:0,class:z({"syllable-content":!0,"is-paused":n.value,"is-disappearing":m.value}),onClick:E},O(r(c).text),3)):V("",!0),B(f("div",se,[_(r(g),{icon:"pi pi-caret-right",severity:"success",rounded:"",outlined:"",size:"large",onClick:R})],512),[[D,!b.value]]),B(f("div",ae,[_(r(g),{icon:"pi pi-pause",severity:"success",rounded:"",outlined:"",size:"large",onClick:N})],512),[[D,n.value]]),d.value&&h.value?(y(),Q(Y,{key:1,class:z({"is-disappearing":S.value})},null,8,["class"])):V("",!0),B(f("div",te,[_(r(g),{icon:"pi pi-refresh",severity:"success",rounded:"",outlined:"",size:"large",onClick:q})],512),[[D,u.value]])]),b.value&&!C.value?(y(),x("div",le,[_(r(g),{icon:"pi pi-step-forward",severity:"success",rounded:"",outlined:"",size:"large",onClick:j})])):V("",!0)]))}});const re=X(oe,[["__scopeId","data-v-1477d20c"]]);export{re as default};
